环境信息
#主题
http://theme-admin-test.nubia.cn/
admin/Neo_6102!Theme
http://theme-api-test.nubia.cn/
测试机器
api 
ssh -p 47461 heping@121.196.238.100
yQR2XwZmGvU7A0HKV1zqmDn9
admin
ssh -p 47461 zhang.sibei@114.55.135.25
T1R7OXOrVxM0UcPOP2od
redis
ssh -p 47461 zhang.sibei@114.55.179.44
T1R7OXOrVxM0UcPOP2od
mysql -h rm-bp1rtopz2hi2ml5ze.mysql.rds.aliyuncs.com
HOgQyLYBlHrRP9vVx7CT
nubia_theme_test
nubia_theme_test

http://admin.theme.nubia.cn/
admin/admin123
http://api.theme.nubia.cn/

#浏览器
测试服务器
http://admin.browser-test.server.nubia.cn/
admin/Nubrowser2015
http://api.browser-test.server.nubia.cn/
http://stat.browser-test.server.nubia.cn/
http://browser-push.server.nubia.cn/
admin/nubrowser2015
分布式日志文件系统
http://10.206.19.237:8255/
browser/logcentre2016
http://test.niudatastats.nubia.com/
nubrowse@test.cn 123456
测试环境阿里云
114.55.250.152  10.24.243.154   浏览器api测试环境
118.178.95.109  10.24.241.242   浏览器admin,push_admin测试环境
118.178.94.228  10.27.212.137        浏览器redis测试环境
114.55.100.75        10.26.235.195         浏览器mongo测试环境、elasticsearch测试环境

port: 47461
username: devbrowser
password: 9HnYSbjiGHs#!^253

RDS地址：
mysql -h rm-bp1d1l1p2cl5r2g2b.mysql.rds.aliyuncs.com -unb_browser_test -p
用户名：nb_browser_test
密码：6egvBNSM5BxPwQFZ4W
数据库名：nubrowser_test


用户名：nb_browser_push
密码：6egvBNSM5BxPwQFZ4W
数据库名：browser_push_test


浏览器数据统计mongo服务器 ：120.27.138.126 
新申请的机器 es集群 120.26.57.243

ssh端口： 47461
登录账户：guming  口令： PNWZShyw1jcLyoUkqQ4SWvgR

内容管理平台
101.37.26.63 api
101.37.28.57 admin/task
101.37.28.53 redis
ssh端口：47461
登录账号：devsre 已授权sudo 
密码：HnYSbjiGHsnvF0ULuu

rds：rm-bp1k46tp7g40n4tae.mysql.rds.aliyuncs.com
数据库：nubia_cms
账号：nubia_cms
口令：HrRP9vVx7CT7XHIQO7JwitPVO


生产环境
http://admin.browser.server.nubia.cn/
getingting/nubrowser2015
wuchengjin/nubrowser2015
http://stat.browser.server.nubia.cn/
http://browser.server.nubia.cn/
http://push.browser.server.nubia.cn/
admin/nubrowser2015
http://admin.monitor.nubia.cn/
gu.ming@zte.com.cn/123456
http://admin-logcenter.nubia.com/
browser/nubrowser2016
http://niudatastats.nubia.com/
jiang.liangmou@zte.com.cn/19820921

连接push数据库
mysql -h rdsa5m0un7i9h7951118.mysql.rds.aliyuncs.com -ugm -p
xZkD9VS7eYl3LN
连接admin数据库
mysql -h rdsd4aw5b0t0k5eg3bw7.mysql.rds.aliyuncs.com -ugm -p
JRgQ5KU1U02PcY
mysql -h rm-bp1d1l1p2cl5r2g2b.mysql.rds.aliyuncs.com -u devbrowser -p
w1jcLyoUkqQ4SWvg

生产环境后台日志下载
http://admin.browser.server.nubia.cn/logs/nubrowser_admin.out
nubia4/qkVf8On49X7F

push nginx反向代理部分[代理1和代理2都指向2个tomcat]
location /push.action {
            proxy_pass http://backend1;
            proxy_set_header   Host             $host;
            proxy_set_header   X-Real-IP        $remote_addr;
            proxy_set_header   X-Forwarded-For  $proxy_add_x_forwarded_for;
            proxy_http_version 1.1;
            proxy_set_header Upgrade $http_upgrade;
            proxy_set_header Connection "upgrade";
            proxy_read_timeout 180;
        }
     location / {
            proxy_pass http://backend2;
            proxy_set_header   Host             $host;
            proxy_set_header   X-Real-IP        $remote_addr;
            proxy_set_header   X-Forwarded-For  $proxy_add_x_forwarded_for;
            proxy_http_version 1.1;
            proxy_set_header Upgrade $http_upgrade;
            proxy_set_header Connection "upgrade";
            proxy_read_timeout 180;
        }


push 后台夜里2点报错导致宕机问题定位
从2016-09-07 02:00:00开始，tomcat2 出现如下问题，2:00:00发送tomcat 内存占用超70%报警，紧接着提示宕机，由此可见jvm有大量内存未释放导致；
时间为整点，所以定位问题是定时任务导致；
排查配置文件，在/data/wwwroot/nubia_browser_push/WEB-INF/application-context.xml中存在如下内容
<bean id="jobSchedulerFactory" lazy-init="false" autowire="no"
		class="org.springframework.scheduling.quartz.SchedulerFactoryBean">
		<property name="triggers">
			<list>
				<ref bean="cleanMessageCronTrigger" />
				<ref bean="cleanMessageHisCronTrigger" />
				<ref bean="cleanSubscriberLinkLogCronTrigger" />
			</list>
		</property>
	</bean>
	<bean id="cleanMessageJob"
		class="org.springframework.scheduling.quartz.MethodInvokingJobDetailFactoryBean">
		<property name="targetObject">
			<ref bean="messageService" />
		</property>
		<property name="targetMethod">
			<value>cleanReceiveMessage</value>
		</property>
	</bean>
	<bean id="cleanMessageCronTrigger" class="org.springframework.scheduling.quartz.CronTriggerBean">
		<property name="jobDetail">
			<ref bean="cleanMessageJob" />
		</property>
		<property name="cronExpression">
			<value>0 0 2 * * ?</value>
		</property>
	</bean>
	
查找cn.nubia.photosns.push.2015.12.24.jar 中MessageServiceImpl 会查询tbl_receive_message 小于当前时间的记录，如果记录过多，会导致查询出的list放到jvm中内存溢出错误
从而导致每天的定时任务都会导致宕机
解决方法：找运维人员执行 delete from tbl_receive_message where life_time < 当天2点转化成秒;
public void cleanReceiveMessage()
  {
    if (1 != Constants.JOB_TASK) {
      return;
    }
    System.out.println("Job : clean ReceiveMessage...");

    String sql = "from ReceiveMessage rm where rm.lifeTime<:lifeTime";
    long lifeTime = System.currentTimeMillis() / 1000L;
    Map params = new HashMap();
    params.put("lifeTime", Long.valueOf(lifeTime));
    List list = this.receiveMessageDao.queryList(sql, params);

    if ((list != null) && (list.size() > 0)) {
      Map timeout = new HashMap();

      for (ReceiveMessage receive : list) {
        if (!timeout.containsKey(receive.getPushId())) {
          timeout.put(receive.getPushId(), Integer.valueOf(1));
        } else {
          Integer timeoutNum = (Integer)timeout.get(receive.getPushId());
          timeoutNum = Integer.valueOf(timeoutNum.intValue() + 1);
          timeout.put(receive.getPushId(), timeoutNum);
        }
        this.log.info("timeout : pushId = " + receive.getPushId() + ", subscriberId = " + receive.getSubscriberId() + ", msg = " + receive.getMsgContent());
      }
      .....	
    }
  }	

push组件测试环境
http://push-admin-test.nubia.com/
mayan/neotheme@2016

浏览器数据统计mongo服务器 ：120.27.138.126 
新申请的机器 es集群 120.26.57.243

ssh端口： 47461
登录账户：guming  口令： PNWZShyw1jcLyoUkqQ4SWvgR

114.55.42.115  guming/guming123
数据库的内网的ip：10.25.67.76
端口3306

发布环境ftp信息
ip：10.206.2.112 端口：21 用户名：guming 口令：jrkFBgeTGAwq3f

jenkins持续构建
http://10.206.63.183:8080/jenkins/login?from=%2Fjenkins%2F
browser/browser@123

Metronomeic下载地址：http://pan.baidu.com/s/1dE2mqyt

umeng账号
https://i.umeng.com/
gu.suzhen@zte.com.cn Gu891127

./jmeter -n -t ../theme_19.jmx -l ../log.jtl